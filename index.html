<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Probation Scheduler | เขต 2 (v28)</title>
<meta name="theme-color" content="#0d3c91"/>
<link rel="icon" href="probation-logo.png" />
<style>
  /* ………… สไตล์เดิมของหน้า (ตัดออกเพื่อย่อ) ………… */

  /* ========== FAB & Panel ========== */
  .quickview-fab{
    position:fixed; right:20px; bottom:24px; z-index:60;
    display:flex; gap:10px; align-items:center;
    background:linear-gradient(135deg,#0d47a1,#1976d2);
    color:#fff; border:none; border-radius:999px; padding:12px 16px;
    box-shadow:0 12px 30px rgba(3,43,108,.24), 0 6px 12px rgba(3,43,108,.18);
    font-weight:700; letter-spacing:.2px; cursor:pointer; transition:.25s;
  }
  .quickview-fab:hover{ transform:translateY(-2px) }
  .quickview-fab svg{ width:20px; height:20px }

  .quickview-panel{
    position:fixed; right:20px; bottom:88px; z-index:59; width:min(480px,92vw);
    background:#fff; border:1px solid #e7eef8; border-radius:16px;
    box-shadow:0 20px 40px rgba(12,46,96,.18),0 8px 16px rgba(12,46,96,.12);
    padding:14px; display:none;
  }
  .quickview-panel.open{ display:block; animation:panelIn .18s ease-out }
  @keyframes panelIn{ from{transform:translateY(8px);opacity:0} to{transform:none;opacity:1} }

  .quickview-title{ display:flex; align-items:center; justify-content:space-between; margin-bottom:10px }
  .quickview-title h4{ margin:0; font-weight:800; color:#0a2257 }
  .quickview-grid{ display:grid; grid-template-columns:1fr 1fr; gap:10px }
  @media(max-width:520px){ .quickview-grid{ grid-template-columns:1fr } }

  .qv-chip{
    display:flex; align-items:center; justify-content:space-between; gap:10px;
    padding:11px 12px; border:1px solid #e6eef8; border-radius:12px;
    background:linear-gradient(180deg,#f9fbff,#f6f9ff);
    color:#0d2a5a; font-weight:700; cursor:pointer;
    box-shadow:0 1px 0 #eef3fb inset; transition:.2s transform,.25s box-shadow,.25s background;
  }
  .qv-chip:hover{ transform:translateY(-1px); box-shadow:0 10px 22px rgba(22,58,126,.10),0 1px 0 #eef3fb inset; background:linear-gradient(180deg,#fff,#f6faff) }
  .qv-chip .sub{ font-size:.82rem; color:#5b7cad; background:#eaf2ff; min-width:72px; text-align:center; padding:2px 8px; border-radius:999px }

  /* ========== Dialog (ทุกอำเภอใช้รูปแบบเดียวกัน) ========== */
  dialog{ border:0; border-radius:14px; padding:14px; box-shadow:0 30px 60px rgba(2,28,68,.25) }
  .modal-head{ display:flex; align-items:center; justify-content:space-between; margin-bottom:10px }
  .year-tabs{ display:flex; gap:8px }
  .year-tabs .tab{
    padding:6px 10px; border-radius:999px; border:1px solid #e6eef8; background:#f3f7ff; color:#0d2a5a; cursor:pointer; font-weight:700
  }
  .year-tabs .tab.active{ background:#0d47a1; color:#fff; border-color:#0d47a1 }
  .month-grid{ display:grid; grid-template-columns:repeat(2,minmax(160px,1fr)); gap:8px }
  .pill{ display:flex; justify-content:space-between; align-items:center; background:#f7fbff; border:1px solid #e6eef8; padding:8px 10px; border-radius:10px }
</style>
</head>
<body>
  <!-- ………… ส่วนหัว/ตั้งค่า/ตารางผลเดิม — คงไว้เหมือนเดิม ………… -->

  <!-- FAB -->
  <button class="quickview-fab" id="qv-fab" title="ดูวันรายเดือน (ปี 69–70)">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="12" cy="12" r="10"/><path d="M8 12h8M12 8v8"/></svg>
    ดูวันรายเดือน
  </button>
  <div class="quickview-panel" id="qv-panel">
    <div class="quickview-title">
      <h4>ดูวันรายเดือน ปี 2569–2570</h4>
      <button class="btn" id="qv-close">ปิด</button>
    </div>
    <div class="quickview-grid">
      <!-- ทุกอำเภอใน FAB -->
      <button class="qv-chip" data-open="wc"><span>เวียงชัย</span><span class="sub">ปี 69–70</span></button>
      <button class="qv-chip" data-open="phan"><span>พาน</span><span class="sub">ปี 69–70</span></button>
      <button class="qv-chip" data-open="wpp"><span>เวียงป่าเป้า</span><span class="sub">ปี 69–70</span></button>
      <button class="qv-chip" data-open="wpn"><span>วัดป่าแงะ</span><span class="sub">ปี 69–70</span></button>
      <button class="qv-chip" data-open="msr"><span>แม่สรวย</span><span class="sub">ปี 69–70</span></button>
      <button class="qv-chip" data-open="mla"><span>แม่ลาว</span><span class="sub">ปี 69–70</span></button>
      <button class="qv-chip" data-open="wcrdl"><span>เวียงเชียงรุ้ง / ดอยหลวง</span><span class="sub">ปี 69–70</span></button>
    </div>
  </div>

  <!-- ========== Dialog Template (สร้างทีละอำเภอ) ========== -->
  <!-- เวียงชัย -->
  <dialog id="dlg-wc">
    <div class="modal-head">
      <strong>วันรายเดือน เวียงชัย</strong>
      <div class="year-tabs">
        <button class="tab active" data-year="2026">ปี 2569</button>
        <button class="tab" data-year="2027">ปี 2570</button>
        <button class="btn" data-close>ปิด</button>
      </div>
    </div>
    <div class="month-grid" id="grid-wc"></div>
  </dialog>

  <!-- พาน -->
  <dialog id="dlg-phan">
    <div class="modal-head">
      <strong>วันรายเดือน พาน</strong>
      <div class="year-tabs">
        <button class="tab active" data-year="2026">ปี 2569</button>
        <button class="tab" data-year="2027">ปี 2570</button>
        <button class="btn" data-close>ปิด</button>
      </div>
    </div>
    <div class="month-grid" id="grid-phan"></div>
  </dialog>

  <!-- เวียงป่าเป้า -->
  <dialog id="dlg-wpp">
    <div class="modal-head">
      <strong>วันรายเดือน เวียงป่าเป้า</strong>
      <div class="year-tabs">
        <button class="tab active" data-year="2026">ปี 2569</button>
        <button class="tab" data-year="2027">ปี 2570</button>
        <button class="btn" data-close>ปิด</button>
      </div>
    </div>
    <div class="month-grid" id="grid-wpp"></div>
  </dialog>

  <!-- วัดป่าแงะ -->
  <dialog id="dlg-wpn">
    <div class="modal-head">
      <strong>วันรายเดือน วัดป่าแงะ</strong>
      <div class="year-tabs">
        <button class="tab active" data-year="2026">ปี 2569</button>
        <button class="tab" data-year="2027">ปี 2570</button>
        <button class="btn" data-close>ปิด</button>
      </div>
    </div>
    <div class="month-grid" id="grid-wpn"></div>
  </dialog>

  <!-- แม่สรวย -->
  <dialog id="dlg-msr">
    <div class="modal-head">
      <strong>วันรายเดือน แม่สรวย</strong>
      <div class="year-tabs">
        <button class="tab active" data-year="2026">ปี 2569</button>
        <button class="tab" data-year="2027">ปี 2570</button>
        <button class="btn" data-close>ปิด</button>
      </div>
    </div>
    <div class="month-grid" id="grid-msr"></div>
  </dialog>

  <!-- แม่ลาว -->
  <dialog id="dlg-mla">
    <div class="modal-head">
      <strong>วันรายเดือน แม่ลาว</strong>
      <div class="year-tabs">
        <button class="tab active" data-year="2026">ปี 2569</button>
        <button class="tab" data-year="2027">ปี 2570</button>
        <button class="btn" data-close>ปิด</button>
      </div>
    </div>
    <div class="month-grid" id="grid-mla"></div>
  </dialog>

  <!-- เวียงเชียงรุ้ง/ดอยหลวง (ใช้ข้อมูลเวียงเชียงรุ้ง) -->
  <dialog id="dlg-wcrdl">
    <div class="modal-head">
      <strong>วันรายเดือน เวียงเชียงรุ้ง / ดอยหลวง</strong>
      <div class="year-tabs">
        <button class="tab active" data-year="2026">ปี 2569</button>
        <button class="tab" data-year="2027">ปี 2570</button>
        <button class="btn" data-close>ปิด</button>
      </div>
    </div>
    <div class="month-grid" id="grid-wcrdl"></div>
  </dialog>

<script>
/* ------------------ PRESETS (คงของเดิมของคุณ) ------------------ */
const presets = {
  "wiangchai-686970": { years: {
    2025:[20,17,24,28,19,23,29,25,22,27,17,22],
    2026:[26,23,30,27,25,29,27,31,28,22,23,28],
    2027:[25,23,22,26,25,21,26,23,27,26,22,27]
  }},
  "phan-686970": { years: {
    2025:[23,20,20,18,22,19,17,21,18,16,20,18],
    2026:[22,19,19,23,21,18,16,20,17,15,20,17],
    2027:[21,18,22,20,17,22,19,23,21,18,23,23]
  }},
  "maesuai-686970": { years: {
    2025:[21,18,18,22,20,17,15,19,16,21,18,16],
    2026:[20,17,17,21,19,16,14,18,15,13,17,15],
    2027:[19,16,16,20,18,15,20,17,21,19,16,21]
  }},
  "maelao-686970": { years: {
    2025:[23,20,20,18,22,19,17,21,18,16,20,18],
    2026:[13,10,10,8,12,9,7,11,8,6,10,8],
    2027:[12,9,9,7,11,8,13,10,14,12,9,14]
  }},
  "wiangpapao-686970": { years: {
    2026:[8,12,12,9,14,11,9,13,10,8,12,9],
    2027:[14,11,11,8,13,10,15,13,16,14,11,16]
  }},
  "watpangae-686970": { years: {
    2026:[29,26,26,24,28,25,23,27,24,26,26,24],
    2027:[28,25,25,29,27,24,29,26,30,28,25,30]
  }},
  "wiangchiangrung-686970": { years: {
    2026:[13,10,17,21,13,16,21,18,15,20,11,15],
    2027:[18,15,15,19,17,14,19,16,20,18,15,20]
  }},
  "doiluang-686970": { years: {
    2026:[13,10,17,21,13,16,21,18,15,20,11,15],
    2027:[18,15,15,19,17,14,19,16,20,18,15,20]
  }}
};
/* ------------------ END PRESETS ------------------ */

/* ========== โค้ดส่วน FAB & Dialogs ========== */
const fab   = document.getElementById('qv-fab');
const panel = document.getElementById('qv-panel');
const btnClosePanel = document.getElementById('qv-close');

fab.addEventListener('click', ()=> panel.classList.toggle('open'));
btnClosePanel.addEventListener('click', ()=> panel.classList.remove('open'));

/** สร้างรายการเดือนให้กล่อง */
function renderYearGrid(gridEl, key, year){
  const monthsTH=['มกราคม','กุมภาพันธ์','มีนาคม','เมษายน','พฤษภาคม','มิถุนายน','กรกฎาคม','สิงหาคม','กันยายน','ตุลาคม','พฤศจิกายน','ธันวาคม'];
  const arr=(presets[key] && presets[key].years && presets[key].years[year]) ? presets[key].years[year] : [];
  gridEl.innerHTML='';
  monthsTH.forEach((name,i)=>{
    const div=document.createElement('div');
    div.className='pill';
    div.innerHTML=`<span>${i+1}. ${name}</span><strong>${arr[i]??'-'}</strong>`;
    gridEl.appendChild(div);
  });
}

/** เปิด dialog แบบเลือกปีได้ */
function attachDialog(openerAttr, dialogId, gridId, presetKeyDefault){
  const opener = document.querySelector(`.qv-chip[data-open="${openerAttr}"]`);
  const dlg    = document.getElementById(dialogId);
  const grid   = document.getElementById(gridId);
  const tabs   = dlg.querySelectorAll('.year-tabs .tab');
  const closeBtn = dlg.querySelector('[data-close]');
  let curYear = 2026; // default แสดงปี 2569 ก่อน

  function paint(){ renderYearGrid(grid, presetKeyDefault, curYear); }
  tabs.forEach(tab=>{
    tab.addEventListener('click', ()=>{
      tabs.forEach(t=>t.classList.remove('active'));
      tab.classList.add('active');
      curYear = parseInt(tab.dataset.year,10);
      paint();
    });
  });
  opener.addEventListener('click', ()=>{ paint(); dlg.showModal(); });
  closeBtn.addEventListener('click', ()=> dlg.close());
}

/* ผูกทุกอำเภอเข้ากับ dialog */
attachDialog('wc',    'dlg-wc',    'grid-wc',    'wiangchai-686970');
attachDialog('phan',  'dlg-phan',  'grid-phan',  'phan-686970');
attachDialog('wpp',   'dlg-wpp',   'grid-wpp',   'wiangpapao-686970');
attachDialog('wpn',   'dlg-wpn',   'grid-wpn',   'watpangae-686970');
attachDialog('msr',   'dlg-msr',   'grid-msr',   'maesuai-686970');
attachDialog('mla',   'dlg-mla',   'grid-mla',   'maelao-686970');
attachDialog('wcrdl', 'dlg-wcrdl', 'grid-wcrdl', 'wiangchiangrung-686970'); // ใช้ชุดเดียวกับเวียงเชียงรุ้ง

/* ========== (ส่วนคำนวณ/ตารางของคุณคงเดิม — ไม่ตัดแปะซ้ำเพื่อย่อข้อความ) ========== */
</script>
</body>
</html>
